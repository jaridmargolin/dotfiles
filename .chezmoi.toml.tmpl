# Chezmoi recommends using CODESPACES but this fails when running local
# devcontainers, so we are going to explicitly check for if we are running in
# a headless environment instead.
# Ref: https://www.chezmoi.io/user-guide/machines/containers-and-vms/
{{- $codespaces:= env "CODESPACES" | not | not -}}
{{- $headless := not stdinIsATTY -}}

# Required for devcontainers so that the install script that is automatically
# called can pass in the sourceDir pointing to the location the dotfiles were
# cloned to (vscode & codespaces use ~/dotfiles).
# Ref: https://www.chezmoi.io/user-guide/machines/containers-and-vms/
sourceDir = {{ .chezmoi.sourceDir | quote }}

[data]
    codespaces = {{ $codespaces }}
    headless = {{ $headless }}
{{- if $headless }}
    computername = "headlesscontainer"
    email = "jaridmargolin@gmail.com"
    [data.languages]
        node = false
        python = false
        ruby = false
        go = false
        yarn = false
        java = false
{{- else }}{{/* Interactive setup, so prompt for values */}}
    computername = {{ promptString "Computer Name (as done via System Preferences â†’ Sharing)" | quote }}
    email = {{ promptString "Email (used as git email)" | quote }}
    [data.languages]
        node = {{ promptBool "Install Node.js via mise" }}
        python = {{ promptBool "Install Python via mise" }}
        ruby = {{ promptBool "Install Ruby via mise" }}
        go = {{ promptBool "Install Go via mise" }}
        yarn = {{ promptBool "Install Yarn via mise" }}
        java = {{ promptBool "Install Java via mise" }}
{{- end }}
